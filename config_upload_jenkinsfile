pipeline {
    agent any

    stages {
        stage('Run GUI Automation') {
            steps {
                sh """
                    # ensure debug dir exists
                    mkdir -p debug_screenshots

                    # activate venv and run automation
                    # capture console output into gui_run.log for debugging
                    ./venv/bin/python scripts/gui_upload.py \
                        > debug_screenshots/gui_run.log 2>&1
                """
            }
        }
    }

    post {
        always {
            // Collect screenshots, HTML dumps, toast logs, network logs, console logs
            archiveArtifacts artifacts: 'debug_screenshots/**/*.*', fingerprint: true
        }
    }
}
