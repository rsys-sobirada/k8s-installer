pipeline {
    agent any

    stages {
        stage('Run GUI Automation') {
            steps {
                sh """
                    # ensure debug dir exists
                    mkdir -p debug_screenshots

                    # install selenium-wire inside venv if missing
                    ./venv/bin/pip install --quiet selenium-wire

                    # run automation and capture console output
                    ./venv/bin/python scripts/gui_upload.py \
                        > debug_screenshots/gui_run.log 2>&1
                """
            }
        }
    }

    post {
        always {
            archiveArtifacts artifacts: 'debug_screenshots/**/*.*', fingerprint: true
        }
    }
}
